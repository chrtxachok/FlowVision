# Конфигурация OCR сервиса

service:
  name: "ocr-service"
  version: "1.0.0"
  host: "0.0.0.0"
  port: 8000
  debug: false
  workers: 4

# Настройки OCR
ocr:
  # Язык по умолчанию
  default_language: "ru"
  
  # Параметры предобработки
  preprocess:
    enhance_contrast: true
    denoise: true
    deskew: true
    remove_borders: true
    target_dpi: 300
  
  # Параметры распознавания текста
  text_detection:
    # Использовать DBNet для обнаружения текста
    use_dbnet: true
    # Минимальная высота текстовой строки
    min_text_height: 10
    # Порог уверенности
    confidence_threshold: 0.7
    # Максимальный размер изображения
    max_image_size: 4096
  
  # Параметры LayoutLM модели
  layoutlm:
    model_name: "microsoft/layoutlm-base-uncased"
    max_seq_length: 512
    num_labels: 51  # Количество классов для NER
  
  # Параметры постобработки
  postprocess:
    fix_spacing: true
    fix_hyphenation: true
    normalize_whitespace: true

# Настройки хранилища (MinIO)
storage:
  endpoint: "minio:9000"
  access_key: "minioadmin"
  secret_key: "minioadmin"
  bucket: "documents"
  secure: false
  timeout: 300

# Настройки Redis
redis:
  host: "redis"
  port: 6379
  db: 0
  password: null
  broker_db: 1
  result_backend_db: 2

# Настройки Celery
celery:
  broker_url: "redis://redis:6379/1"
  result_backend: "redis://redis:6379/2"
  task_serializer: "json"
  result_serializer: "json"
  accept_content: ["json"]
  timezone: "UTC"
  enable_utc: true
  task_track_started: true
  task_time_limit: 3600  # 1 час
  task_soft_time_limit: 3300  # 55 минут
  worker_prefetch_multiplier: 1

# Настройки мониторинга
monitoring:
  enable_prometheus: true
  prometheus_port: 9090
  log_level: "INFO"
  log_format: "json"

# Лимиты
limits:
  max_file_size: 52428800  # 50 MB
  max_pages: 100
  request_timeout: 300
